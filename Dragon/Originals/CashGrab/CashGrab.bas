10 DIMH(16),I(16),A(1),B(1),C(1),P(1),R(1),M(16,11),N(11),X,Y,V,W,D,J,R,L,S,M
20 FORI=0TO15:H(I)=I*16:NEXT
30 REM SET UP GRAPHICS
40 PMODE0,1:PCLS:SCREEN1,1
50 GET(0,0)-(15,15),B
60 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
70 GET(0,0)-(15,15),A
80 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
90 GET(0,0)-(15,15),R
100 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
110 GET(0,0)-(15,15),C
120 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
130 GET(0,0)-(15,15),P
140 GOSUB500:REM INIT GAME
150 GOSUB530:REM INIT LEVEL
160 PCLS:GOSUB460
170 REM GAME LOOP
180 A$=INKEY$:IFA$="P"THENX=X+1ELSEIFA$="O"THENX=X-1
190 IFA$="Q"THENY=Y-1ELSEIFA$="A"THENY=Y+1
200 J=JOYSTK(0):IFJ=0THENX=X-1ELSEIFJ=63THENX=X+1
210 J=JOYSTK(1):IFJ=0THENY=Y-1ELSEIFJ=63THENY=Y+1
220 IFX<0THENX=0 ELSE IFX>15THENX=15
230 IFY<1THENY=1 ELSE IFY>11THENY=11
240 GOSUB 330
250 IF X=V THEN IF Y=W THEN 270
260 PUT(H(X),H(Y))-(H(X)+15,H(Y)+15),A,PSET:PUT(H(V),H(W))-(H(V)+15,H(W)+15),B,PSET:V=X:W=Y
270 GOSUB 300
280 GOTO 180 : REM CONTINUE LOOP
290 REM CHECK LOCATION
300 Z=M(X,Y):IFZ=0THENRETURN
310 ON Z GOSUB360,390,420
320 RETURN
330 REM DRAW SCREEN UPDATES
340 R=RND(11):IF N(R)>0 THEN N(R)=N(R)-1:O=N(R):M(O,R)=1:PUT(H(O),H(R))-(H(O)+15,H(R)+15),R,PSET
350 RETURN
360 REM BURN
370 SCREEN1,0
380 RETURN
390 REM SCORE
400 M(X,Y)=0
410 RETURN
420 REM PORTAL
430 GOTO150
440 RETURN
450 REM DRAW INTIAL SCREEN
460 LINE(0,15)-(255,15),PSET
470 REM PUT(H(3),H(5))-(H(3)+15,H(5)+15),C,PSET
480 PUT(H(0),H(R))-(H(0)+15,H(R)+15),P,PSET
481 FORI=1TOM:PUT(H(I),H(0))-(H(I)+15,H(0)+15),A,PSET:NEXT
490 RETURN
500 REM INIT GAME
510 L=1:S=0:M=3
520 RETURN
530 REM LEVEL SET UP
540 X=0:Y=2:V=1:W=1
550 GOSUB 590
560 M(3,5)=2:REM CASH BAG
570 R=RND(11):M(0,R)=3:REM PORTAL
580 RETURN
590 REM RESET LEVEL DATA
600 FORJ=0TO16:FORI=0TO11:M(J,I)=0:NEXT:NEXT: REM SCREEN LAYOUT
610 FORI=0TO11:N(I)=16:NEXT: REM LAVA POSITIONS
620 RETURN
630 REM STICK MAN
640 DATA24,60,24,126,24,24,36,66
650 REM LAVA
660 DATA97,95,204,32,244,31,120,30
670 REM CASH
680 DATA0,0,60,24,60,126,126,60
690 REM PORTAL
700 DATA126,129,189,165,165,189,129,126
710 REM