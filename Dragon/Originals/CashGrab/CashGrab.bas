10 DIMH(16),I(16),A(1),B(1),C(1),P(1),R(1),M(16,11),N(11),X,Y,V,W,D,J,R,L,S,M,Q
20 DIMC$(27),N$(10):GOSUB850:REM SET UP TEXT
30 FORI=0TO15:H(I)=I*16:NEXT
40 GOSUB580:REM SET UP GRAPHICS
50 GOSUB440:REM INIT GAME
60 GOSUB470:REM INIT LEVEL
70 PCLS:GOSUB370
80 REM GAME LOOP
90 A$=INKEY$:IFA$="P"THENX=X+1ELSEIFA$="O"THENX=X-1
100 IFA$="Q"THENY=Y-1ELSEIFA$="A"THENY=Y+1
110 J=JOYSTK(0):IFJ=0THENX=X-1ELSEIFJ=63THENX=X+1
120 J=JOYSTK(1):IFJ=0THENY=Y-1ELSEIFJ=63THENY=Y+1
130 IFX<0THENX=0 ELSE IFX>15THENX=15
140 IFY<1THENY=1 ELSE IFY>11THENY=11
150 GOSUB 240
160 IF X=V THEN IF Y=W THEN 180
170 PUT(H(X),H(Y))-(H(X)+15,H(Y)+15),A,PSET:PUT(H(V),H(W))-(H(V)+15,H(W)+15),B,PSET:V=X:W=Y
180 GOSUB 210
190 GOTO 90 : REM CONTINUE LOOP
200 REM CHECK LOCATION
210 Z=M(X,Y):IFZ=0THENRETURN
220 ON Z GOSUB270,300,330
230 RETURN
240 REM DRAW SCREEN UPDATES
250 R=RND(11):IF N(R)>0 THEN N(R)=N(R)-1:O=N(R):M(O,R)=1:PUT(H(O),H(R))-(H(O)+15,H(R)+15),R,PSET
260 RETURN
270 REM BURN
280 SCREEN1,0
290 RETURN
300 REM SCORE
310 M(X,Y)=0
320 RETURN
330 REM PORTAL
340 GOTO60
350 RETURN
360 REM DRAW INTIAL SCREEN
370 LINE(0,15)-(255,15),PSET
380 HP=2:VP=2:O$="LIVES": GOSUB790
390 HP=130:VP=2:O$="SCORE": GOSUB790
400 REM PUT(H(3),H(5))-(H(3)+15,H(5)+15),C,PSET
410 PUT(H(0),H(R))-(H(0)+15,H(R)+15),P,PSET
420 REM FORI=1TOM:PUT(H(I),H(0))-(H(I)+15,H(0)+15),A,PSET:NEXT
430 RETURN
440 REM INIT GAME
450 L=1:S=0:M=3
460 RETURN
470 REM LEVEL SET UP
480 X=0:Y=2:V=1:W=1
490 GOSUB 530
500 M(3,5)=2:REM CASH BAG
510 R=RND(11):M(0,R)=3:REM PORTAL
520 RETURN
530 REM RESET LEVEL DATA
540 FORJ=0TO16:FORI=0TO11:M(J,I)=0:NEXT:NEXT: REM SCREEN LAYOUT
550 FORI=0TO11:N(I)=16:NEXT: REM LAVA POSITIONS
560 RETURN
570 REM DRAW GFX
580 PMODE0,1:PCLS:SCREEN1,1
590 GET(0,0)-(15,15),B
600 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
610 GET(0,0)-(15,15),A
620 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
630 GET(0,0)-(15,15),R
640 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
650 GET(0,0)-(15,15),C
660 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
670 GET(0,0)-(15,15),P
680 RETURN
690 REM STICK MAN
700 DATA24,60,24,126,24,24,36,66
710 REM LAVA
720 DATA97,95,204,32,244,31,120,30
730 REM CASH
740 DATA0,0,60,24,60,126,126,60
750 REM PORTAL
760 DATA126,129,189,165,165,189,129,126
770 REM
780 REM DISPLAY TEXT
790 FORQ=1TOLEN(O$):DRAW"BM"+STR$(HP)+","+STR$(VP)+";"+C$(ASC(MID$(O$,Q,1))-64):HP=HP+8:NEXT
800 RETURN
810 REM DISPLAY NUMBERS
820 FORQ=1TOLEN(N$):DRAW"BM"+STR$(HP)+","+STR$(VP)+";"+N$(ASC(MID$(N$,Q,1))-48):HP=HP+8:NEXT
830 RETURN
840 REM LETTER DATA
850 C$(1)="D8U8R4D4L4R4D4"
860 C$(2)="R5D8L5U8D4R4"
870 C$(3)="R4L4D8R4"
880 C$(4)="D8R3E1U6M-4,-1"
890 C$(5)="R4L4D4R4L4D4R4"
900 C$(6)="R4L4D4R4L4D4"
910 C$(7)="R4L4D8R4U4"
920 C$(8)="D8U4R4U4D8"
930 C$(9)="R4L2D8R2L4"
940 C$(10)="R4L2D8L2"
950 C$(11)="D8U4M+4,-4M-4,+4M+4,+4"
960 C$(12)="D8R4"
970 C$(13)="D8U8M+2,+2M+2,-2D8"
980 C$(14)="D8U8M+5,+8U8"
990 C$(15)="D8R4U8L4"
1000 C$(16)="D8U8R4D4L4"
1010 C$(17)="D6R4D2U8L4"
1020 C$(18)="D8U8R4D4L4F4"
1030 C$(19)="R5L5D4R4D4L4"
1040 C$(20)="R4L2D8"
1050 C$(21)="D8R4U8"
1060 C$(22)="D6F2E2U6"
1070 C$(23)="D6F2E2U6D6F2E2U6"
1080 C$(24)="M+4,+8BM+0,-8M-4,+8"
1090 C$(25)="D4R4U4D4L2D4"
1100 C$(26)="R4D2G2G2D2R4"
1110 REM NUMBERS
1120 N$(0)="D8R4U8L4"
1130 N$(1)="BM+2,+0D8"
1140 N$(2)="D2U2R4D4G4R4"
1150 N$(3)="R4D4L4R4D4L4"
1160 N$(4)="D4R4U4D8"
1170 N$(5)="R5L5D4R4D4L4"
1180 N$(6)="R5L5D4R4D4L4U4"
1190 N$(7)="R5D8"
1200 N$(8)="R5D8L5U8D4R4"
1210 N$(9)="R5D8U4L4U4"
1220 RETURN
1230 REM