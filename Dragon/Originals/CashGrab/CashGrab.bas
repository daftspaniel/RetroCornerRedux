10 DIMH(16),I(16),A(1),B(1),C(1),P(1),R(1),M(16,11),N(11),X,Y,V,W,D,J,R,L,S,M,Q
20 DIMC$(27),N$(10):GOSUB900:REM SET UP TEXT
30 FORI=0TO15:H(I)=I*16:NEXT
40 GOSUB590:REM SET UP GRAPHICS
50 GOSUB700:REM TITLE SCREEN
60 GOSUB450:REM INIT GAME
70 GOSUB480:REM INIT LEVEL
80 PCLS:GOSUB380
90 REM GAME LOOP
100 A$=INKEY$:IFA$="P"THENX=X+1ELSEIFA$="O"THENX=X-1
110 IFA$="Q"THENY=Y-1ELSEIFA$="A"THENY=Y+1
120 J=JOYSTK(0):IFJ=0THENX=X-1ELSEIFJ=63THENX=X+1
130 J=JOYSTK(1):IFJ=0THENY=Y-1ELSEIFJ=63THENY=Y+1
140 IFX<0THENX=0ELSEIFX>15THENX=15
150 IFY<1THENY=1ELSEIFY>11THENY=11
160 GOSUB 250
170 IF X=V THEN IF Y=W THEN 190
180 PUT(H(X),H(Y))-(H(X)+15,H(Y)+15),A,PSET:PUT(H(V),H(W))-(H(V)+15,H(W)+15),B,PSET:V=X:W=Y
190 GOSUB 220
200 GOTO 100 : REM CONTINUE LOOP
210 REM CHECK LOCATION
220 Z=M(X,Y):IFZ=0THENRETURN
230 ON Z GOSUB280,310,340
240 RETURN
250 REM DRAW SCREEN UPDATES
260 R=RND(11):IF N(R)>0 THEN N(R)=N(R)-1:O=N(R):M(O,R)=1:PUT(H(O),H(R))-(H(O)+15,H(R)+15),R,PSET
270 RETURN
280 REM BURN
290 SCREEN1,0
300 RETURN
310 REM SCORE
320 M(X,Y)=0
330 RETURN
340 REM PORTAL
350 GOTO70
360 RETURN
370 REM DRAW INTIAL SCREEN
380 LINE(0,15)-(255,15),PSET
390 HP=2:VP=2:O$="LIVES": GOSUB840
400 HP=130:VP=2:O$="SCORE": GOSUB840
410 REM PUT(H(3),H(5))-(H(3)+15,H(5)+15),C,PSET
420 PUT(H(0),H(R))-(H(0)+15,H(R)+15),P,PSET
430 HP=55:VP=2:N$=MID$(STR$(M),2):GOSUB870
440 RETURN
450 REM INIT GAME
460 L=1:S=0:M=3
470 RETURN
480 REM LEVEL SET UP
490 X=0:Y=2:V=1:W=1
500 GOSUB 540
510 M(3,5)=2:REM CASH BAG
520 R=RND(11):M(0,R)=3:REM PORTAL
530 RETURN
540 REM RESET LEVEL DATA
550 FORJ=0TO16:FORI=0TO11:M(J,I)=0:NEXT:NEXT: REM SCREEN LAYOUT
560 FORI=0TO11:N(I)=16:NEXT: REM LAVA POSITIONS
570 RETURN
580 REM DRAW GFX
590 PMODE0,1:PCLS:SCREEN1,1
600 GET(0,0)-(15,15),B
610 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
620 GET(0,0)-(15,15),A
630 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
640 GET(0,0)-(15,15),R
650 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
660 GET(0,0)-(15,15),C
670 FORL=0TO7:READD:POKE1536+(L*16),D:NEXT
680 GET(0,0)-(15,15),P
690 RETURN
700 REM TITLE SCREEN
710 PCLS
720 HP=120:VP=40:O$="CASH@GRAB": GOSUB840
730 FORD=1TO4000:NEXT
740 RETURN
750 REM STICK MAN
760 DATA24,60,24,126,24,24,36,66
770 REM LAVA
780 DATA97,95,204,32,244,31,120,30
790 REM CASH
800 DATA0,0,60,24,60,126,126,60
810 REM PORTAL
820 DATA126,129,189,165,165,189,129,126
830 REM DISPLAY TEXT
840 FORQ=1TOLEN(O$):DRAW"BM"+STR$(HP)+","+STR$(VP)+";"+C$(ASC(MID$(O$,Q,1))-64):HP=HP+8:NEXT
850 RETURN
860 REM DISPLAY NUMBERS
870 FORQ=1TOLEN(N$):DRAW"BM"+STR$(HP)+","+STR$(VP)+";"+N$(ASC(MID$(N$,Q,1))-48):HP=HP+8:NEXT
880 RETURN
890 REM LETTER DATA
900 C$(1)="D8U8R4D4L4R4D4"
910 C$(2)="R5D8L5U8D4R4"
920 C$(3)="R4L4D8R4"
930 C$(4)="D8R3E1U6M-4,-1"
940 C$(5)="R4L4D4R4L4D4R4"
950 C$(6)="R4L4D4R4L4D4"
960 C$(7)="R4L4D8R4U4"
970 C$(8)="D8U4R4U4D8"
980 C$(9)="R4L2D8R2L4"
990 C$(10)="R4L2D8L2"
1000 C$(11)="D8U4M+4,-4M-4,+4M+4,+4"
1010 C$(12)="D8R4"
1020 C$(13)="D8U8M+2,+2M+2,-2D8"
1030 C$(14)="D8U8M+5,+8U8"
1040 C$(15)="D8R4U8L4"
1050 C$(16)="D8U8R4D4L4"
1060 C$(17)="D6R4D2U8L4"
1070 C$(18)="D8U8R4D4L4F4"
1080 C$(19)="R5L5D4R4D4L4"
1090 C$(20)="R4L2D8"
1100 C$(21)="D8R4U8"
1110 C$(22)="D6F2E2U6"
1120 C$(23)="D6F2E2U6D6F2E2U6"
1130 C$(24)="M+4,+8BM+0,-8M-4,+8"
1140 C$(25)="D4R4U4D4L2D4"
1150 C$(26)="R4D2G2G2D2R4"
1160 REM NUMBERS
1170 N$(0)="D8R4U8L4"
1180 N$(1)="BM+2,+0D8"
1190 N$(2)="D2U2R4D4G4R4"
1200 N$(3)="R4D4L4R4D4L4"
1210 N$(4)="D4R4U4D8"
1220 N$(5)="R5L5D4R4D4L4"
1230 N$(6)="R5L5D4R4D4L4U4"
1240 N$(7)="R5D8"
1250 N$(8)="R5D8L5U8D4R4"
1260 N$(9)="R5D8U4L4U4"
1270 RETURN
1280 REM