10 REM TANDY (EXTENDED) -ROADRACE
20 PCLEAR 4:PMODE 3,1
100 NC=3:MD=44
110 DIM NM$(NC), LE(NC), ND(NC), RE(NC), DR(NC, MD, 1)
120 FOR CI=1 TO NC: READ NM$ (CI), LE (CI), ND(CI), RE(CI)
130 FOR SI=0 TO 1:FOR LI=1 TO ND(CI) 
140 READ DR(CI, LI,SI)
150 NEXT LI,SI, CI
200 DATA HOCKENHEIM (GERMANY),6.789,25,87.5 
210 DATA 161,38, 11, 32, 41, 138, 127, 66, 125, 36, 35, 34, 55, 44, 103, 14
220 DATA 15, 16, 117, 36, 35, 34, 253, 32,51 
230 DATA 151,38,31,32,21,118, 107, 46, 125, 36, 15, 34, 55, 24, 103, 34
240 DATA 35, 36, 117, 16, 15, 14, 233, 12,41 
300 DATA ANDERSTORP (SWEDEN), 4.018,35,123.8
310 DATA 341,38,47, 38, 187, 36, 195,44,43,42,31,18,61,22,73,24,155 
320 DATA 16, 17, 18, 187, 46, 45, 44, 63, 12, 53, 22, 13, 14, 75, 34, 73,42,41
330 DATA 331, 18, 47, 38, 167, 16, 175, 24, 23, 22, 11, 18,81,42,93,44,175
340 DATA 36,37, 18, 167, 26, 25, 24, 43, 12, 53, 22, 33, 34, 75, 14,53,22,31 
400 DATA INTERLAGOS (BRAZIL), 7.96,44,175.3
410 DATA 351,58, 127, 176, 205, 114, 73, 32, 31, 78, 67, 18, 11,52,31,38
420 DATA 27,21,42, 23, 84, 23, 32,21,68,41, 22, 33, 24,235,26,27,28,71 
430 DATA 38,27,36,85,104,25,34,53,32,51
440 DATA 341,38, 107, 156, 185, 94, 53, 12,11,58,67,38,31,52,11,18
450 DATA 27,28,41,62,43,84, 12, 68, 61, 42,53,44,255,46,47,48,71,18
460 DATA 16,65, 104, 25, 14, 33, 12, 21,11,11
500 DIM LA(2), UA(2), RA(2), DA(2), LV(2), UV(2), RV (2), DV(2)
510 FOR PL=1 TO 2
520 READ LA(PL), LV(PL), UA(PL), UV(PL)
530 READ RA(PL), RV(PL), DA(PL), DV(PL)
540 NEXT PL
550 DATA 342,-248,339,-252,341,-252,340,-248
560 DATA 341,-224,338,-255,338,-192,345,-224
600 DIM DR$(1):DR$(0)="BM50,10": DR$ (1)="BM50,25" 
610 FR=.9:F1=55:F2=60*F1
700 DIM XN(2), YN(2), XM (2), YM(2), X0(2), YO(2), VX(2), VY(2)
710 DIM DT(PL), RO(2), LT(2), MT(2), FT(2)
800 GOTO 3000
810 REM
1000 REM**INITIALIZE** REM GAME CONSTANTS
1020 CLS: INPUT" ONE OR TWO PLAYERS"; NP: IF NP<1 OR NP>2 THEN 1020
1030 INPUT" JOYSTICKS"; AN$: JO=(LEFT$(AN$, 1)="Y")
1040 PRINT "WHICH CIRCUIT DO YOU WANT?"
1050 FOR CI=1 TO NC:PRINT CI;CHR$ (8)") "NM$(CI):NEXT 
1060 INPUT DC: DC=INT (DC): IF DC<1 OR DC>NC THEN 1060
1070 INPUT" NUMBER OF LAPS";NR:NR=INT(NR):IF NR<1 THEN 1070
1080 REM GAME VARIABLES 
1090 FOR PL=1 TO 2
1100 XN(PL)=50: XM(PL)=50:XO(PL)=50:VX(PL)=0
1110 YN(PL)=10+5*PL:YM(PL)=YN(PL):YO(PL)=YN(PL):VY(PL)=0 
1120 DT(PL)=0:MT(PL)=1E6:LT(PL)=0:RO(PL)=0
1130 NEXT PL 
1140 NF=0:MI=0
1150 RETURN
1160 REM
1200 REM**DRAW THE CIRCUIT** 
1210 COLOR 1,3:PCLS: SCREEN 1,0
1220 FOR SI=0 TO 1:DRAW DR$ (SI) 
1230 FOR LI=1 TO ND (DC)
1240 DR=DR(DC, LI,SI) :LE=INT (DR/10):DI=DR-10*LE
1250 FOR TI=1 TO LE
1260 ON DI GOSUB 1320, 1330, 1340, 1350, 1360, 1370, 1380, 1390
1270 NEXT TI,LI,SI 
1280 PAINT (0,0): PAINT (50,50)
1290 DRAW" C3; BM70,40; NL20; NG5; NH5"
1300 FOR PL=1 TO NP: PSET(XN (PL), YN(PL), 2):NEXT
1310 RETURN
1320 DRAW"M+5,+0": RETURN 
1330 DRAW"M+5,-5" : RETURN
1340 DRAW"M+0,-5" : RETURN 
1350 DRAW"M-5,-5": RETURN
1360 DRAW"M-5,+0": RETURN 
1370 DRAW"M-5,+5" : RETURN
1380 DRAW"M+0,+5" : RETURN
1390 DRAW"M+5,+5" : RETURN
1395 REM
1400 REM**STARTSIGN**
1410 COLOR 4,1
1420 FOR CO=0 TO 20 STEP 10:LINE (1, CO)-(6, CO+6), PSET, BF: NEXT 
1430 FOR CO=0 TO 20 STEP 10
1440 FOR DE=1 TO 200:NEXT:SOUND 150,5
1450 LINE(1,CO)-(6,CO+6),PRESET,BF
1460 NEXT CO:TIMER=0
1470 RETURN
1480 REM
1500 REM**INPUT ACCELERATION**
1510 IF JO THEN 1570
1520 AL=-((PEEK(LA(PL)) AND LV(PL))=0)
1530 AR=-((PEEK(RA(PL)) AND RV(PL))=0) 
1540 AU=-((PEEK(UA(PL)) AND UV(PL))=0)
1550 AD=-((PEEK(DA(PL)) AND DV(PL))=0)
1560 GOTO 1600
1570 DU=JOYSTK(0)
1580 AR=SGN(FIX((JOYSTK (2*PL-2)-32)/25))
1590 AD=SGN(FIX((JOYSTK (2*PL-1)-32)/25))
1600 RETURN
1610 REM
1700 REM**COMPUTE NEW SPEED&PLACE**
1710 VX(PL)=(VX(PL)-AL+AR)*FR
1720 VY(PL)=(VY(PL)-AU+AD)*FR
1730 X0(PL)=XM(PL):XM(PL)=XN(PL):XN(PL)=XN(PL)+INT(VX(PL))
1740 YO(PL)=YM(PL):YM(PL)=YN(PL):YN(PL)=YN(PL)+INT(VY(PL))
1750 RETURN
1760 REM
1800 REM**NEW POSITION ON SCREEN** 
1810 LINE(X0(PL), YO(PL))-(XM(PL), YM (PL)),PRESET
1820 IF PPOINT(XN(PL), YN (PL))>1 THEN 1850
1830 DT(PL)=INT (ABS(VX(PL))+ABS(VY(PL)))
1840 VX(PL)=0:VY(PL)=0:XN(PL)=XM(PL): YN(PL)=YM (PL)
1850 LINE(XM(PL), YM(PL))-(XN(PL), YN(PL)),PSET
1860 RETURN
1870 REM
1900 REM**ADAPT VARIABLES**
1910 TI=TIMER/F1+MI
1920 IF TI-MI>F2 THEN TIMER=TIMER-F2:MI=MI+60
1930 FOR PL=1 TO 2
1940 IF XN(PL)<=50 OR XM(PL)>50 OR YN (PL)>30 THEN 2000
1950 RT=TI-LT(PL): IF RT<30 THEN 2000 
1960 LT(PL)=TI
1970 IF RT<MT (PL) THEN MT (PL)=RT 
1980 RO(PL)=RO (PL)+1: IF RO(PL)<>NR THEN 2000 
1990 NF=NF+1:FT (PL)=TI:SOUND 250,2
2000 NEXT PL 
2010 RETURN
2020 REM
2100 REM**END OF THE GAME**
2110 CLS: PRINT"CIRCUIT:"NM $ (DC): PRINT "LENGTH: "LE (DC) "KM"
2120 PRINT" RECORD TIME:";:TI=RE (DC):GOSUB 2220: PRINT
2130 PRINT" NUMBER OF LAPS: "NR
2140 PRINT TAB(12) "TIME" TAB(20) "SPEED (MPH)"
2150 FOR PL=1 TO NP
2160 IF NP=2 THEN PRINT" PLAYER" PL
2170 PRINT" TOTAL: ";:TI=FT (PL):GOSUB 2220: PRINT
2180 PRINT "AVERAGE:";:TI=TI/NR:GOSUB 2220:GOSUB 2230 
2190 PRINT "FASTEST: "::TI=TI/NR:GOSUB 2220:GOSUB 2230
2200 IF TI<RE (DC) THEN PRINT TAB(5) "NEW TRACK RECORD!!"
2210 NEXT PL: RETURN 
2220 MI=INT (TI/60): PRINT USING"##:##.#";MI, TI-60*MI;:RETURN
2230 PRINT USING" ###.##";3600*LE (DC)/TI: RETURN
3000 REM**MAIN PROGRAM**
3010 GOSUB 1000' INITIALIZE
3020 GOSUB 1200' SCREEN
3030 GOSUB 1400'START
3040 COLOR 2,3
3050 FOR PL=1 TO 2
3060 IF PL>NP THEN FOR DE=1 TO 150:NEXT:GOTO 3110 
3070 IF DT(PL)>0 THEN DT (PL)=DT (PL)-1: SOUND 10*PL,3:GOTO 3110
3080 GOSUB 1500' INPUT
3090 GOSUB 1700' COMPUTING
3100 GOSUB 1800' OUTPUT
3110 NEXT PL
3120 GOSUB 1900' ADAPT 
3130 IF NF<NP THEN 3050
3140 GOSUB 2100' END
3150 INPUT" ANOTHER RACE (Y/N)?"; AN$: IF LEFT$(AN$, 1)="Y" THEN 3000
3160 END
